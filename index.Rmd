---
title: "A course on Gadget"
output: 
  html_document:
    fig_height: 4
    fig_width: 8
    highlight: haddock
    theme: united
    toc: yes
    toc_float: yes
bibliography: library.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Preamble


### Course objectives

This course is an introduction to using Gadget as an ecosystem simulator 
and stock assessment tool. It is introduced using Rgadget, an R library 
that simplifies and standardizes the procedure for creating the input model 
files needed for creating a Gadget model, as well as gather and visualize 
ouput files created by Gadget. Although input files can be created manually,
Rgadget facilitates reproducability and aids internal consistency of Gadget 
model creation by allowing Gadget models to be created, run, analyzed, and 
shared using a single set of R scripts. Please note, however, that both
Gadget and Rgadget are continuously being developed, so please remember to
update your installations frequently (1x / month). In addition, Rgadget is 
programmed using 'tidyverse', so a good understanding of how to program using 
tidyverse is a necessity. 

By the end of this course you should:

* correctly structure and format input files for building a simple Gadget
model and running a simulation via R using Rgadget
* become familiar enough with the various options in Gadget and how to implement
them using the Gadget User Guide that comes with the Gadget installation,
so that a more complex ecosystem can be simulated
* input data, generate likelihood components, and modify optimisation settings 
* understand the iterative reweighting procedure implemented in Rgadget
* become familiar with predefined figures and data frames generated by gadget.fit

### Your a priori homework

**Prior to the course** make sure your operating system is a unix derivative, 
such as linux or macosx, as the code and examples in this course is only tested 
against these operating systems. Windows should in theory work, but issues related 
to Windows line endings are known to cause random issues in Gadget. For those who do 
not want dual boot their computers they can install [VirtualBox](https://www.virtualbox.org/) 
and install linux on a virtual machine (you can find a selection of pre-install images 
[here](https://www.osboxes.org/virtualbox-images/) where it is recommended that you choose Ubuntu). 
However if you insist on using Windows you should install the `icesTAF` R-package to handle all the file conversion issues.  

To install Gadget follow the [installation guide](Gadget_installation.html). 

Please also have the most recent version of [R](https://cran.r-project.org/) and [Rstudio](https://www.rstudio.com/) installed.

In addition, if you plan to run a simple model using your own data, please:

1. familiarize yourself with [tidyverse programming](Tidyverse.html)

2. think about your model structure/ aggregation level and have R scripts ready that 
aggregate your data into an appropriately formatted data frame (i.e., columns of :
year, time step, area, age bins, length bins, or age- and length-bins - have a sneak
peak at our example model data [here](data_provided.zip))

# Time and location
___

__Time__: 2019-09-30 09:00 - 2019-10-04 12:00

__Location__:
```{r, fig.width = 9, fig.height = 3, message = FALSE, echo=FALSE, warning=FALSE}
library(leaflet)
content <- paste(sep = "<br/>",
  "<b><a href='http://www.hafogvatn.is'>Hafro</a></b>",
  "Skúlagata 4",
  "101 Reykjavík, Iceland"
)
leaflet() %>% 
  addTiles() %>% 
  setView(lng = -21.93016, lat = 64.14897, zoom = 15) %>%
   addPopups(-21.93016,64.14897, content,
             options = popupOptions(closeButton = FALSE))
```

# Draft workplan

### Monday

* Internet access
* [Introduction](introduction.html)
* [Introduction to tidyverse](Tidyverse.html)
* Deal with installation issues
* [Getting started](getting_started.html)
* [Model variable](day1_continued.html#gadget_variables)
* [Fleets and selection](day1_continued.html#predation)
* [Recruitment](day1_continued.html#predation)
* Discussions

---

### Tuesday
* Recap and examples 
* More complicated models: [Ling in Iceland](day2_lingmodel.html)
  + Growth
  + Maturation as a multi-'stock' process
  + Initial conditions
  + Recruitment
  + Fleet operations
* Own projects

---

### Wednesday
* [Introducing likelihood functions](day3_fitlingmodel.html#introducing_likelihood_functions)
* [Incorporating data](day3_fitlingmodel.html#fitting_a_gadget_model_to_data) (Ling case study cont.)
* Set [optimisation function parameters](day3_fitlingmodel.html#set_optimisation_routine) and fit Gadget statistical model using [iterative reweighting](day3_fitlingmodel.html#using_the_iterative_reweighting_function_to_fit_a_gadget_statistical_model)
* [Visualize Gadget statistical model fit](day3_fitlingmodel.html#visualize_gadget_statistical_model_fit)
* Own projects

---

### Thursday
* [Alternate structures](day4_multi_area.html)
  + Multiple areas
  + Migration
* [Stock interactions](stock_interactions.html)
  + [Multiple stocks/species](stock_interactions.html#fish_recruits_into_a_stock)
  + Straying
  + [Spawning](stock_interactions.html#spawning)
    * [Time variables](stock_interactions.html#time_variables)
  + [Consumption](stock_interactions.html#consumption)
* [Order of operations](https://hafro.github.io/gadget/docs/userguide#order_of_calculations)
* MFDB
* Version control
* Own projects

---
### Friday
* [Troubleshooting](troubleshooting.html)
  + Known issues
  + Asking for help
* When to use Gagdet? Some examples.
  + Ling
  + Northern shrimp
  + Atlantic wolffish
* MSE using Gadget
  + Ling 
* Wrap up